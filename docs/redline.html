<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legal Services Portal - Redline Assistant</title>
    <link rel="stylesheet" href="style.css">
    <script>
        (function() {
            var auth = localStorage.getItem('legal-portal-auth');
            var authTime = localStorage.getItem('legal-portal-auth-time');
            var maxAge = 24 * 60 * 60 * 1000;
            if (auth !== 'authenticated' || !authTime || (Date.now() - parseInt(authTime)) > maxAge) {
                window.location.href = 'index.html';
            }
        })();
    </script>
    <style>
        .upload-zone {
            border: 2px dashed var(--border);
            border-radius: 6px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.15s ease;
            background: var(--bg-white);
        }
        .upload-zone:hover {
            border-color: var(--accent);
            background: #F0F7FF;
        }
        .upload-zone.dragover {
            border-color: var(--accent);
            background: #E8F2FF;
        }
        .upload-zone.has-file {
            border-color: var(--success);
            background: #ECFDF5;
        }
        .upload-zone .icon {
            font-size: 40px;
            margin-bottom: 12px;
        }
        .upload-zone input[type="file"] {
            display: none;
        }
        .upload-zone .file-name {
            color: var(--success);
            font-weight: 600;
            margin-top: 10px;
        }
        .document-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .document-grid {
                grid-template-columns: 1fr;
            }
        }
        .change-item {
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 16px;
            background: var(--bg-white);
        }
        .change-item.high {
            border-left: 3px solid var(--danger);
        }
        .change-item.medium {
            border-left: 3px solid var(--warning);
        }
        .change-item.low {
            border-left: 3px solid var(--success);
        }
        .change-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .change-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .badge-impact {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .badge-impact.high { background: #FEF2F2; color: #B91C1C; }
        .badge-impact.medium { background: #FFFBEB; color: #92400E; }
        .badge-impact.low { background: #ECFDF5; color: #065F46; }
        .badge-favor {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .badge-favor.favorable { background: #ECFDF5; color: #065F46; }
        .badge-favor.unfavorable { background: #FEF2F2; color: #B91C1C; }
        .badge-favor.neutral { background: var(--bg-gray); color: var(--text-muted); }
        .text-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 16px 0;
        }
        @media (max-width: 600px) {
            .text-comparison {
                grid-template-columns: 1fr;
            }
        }
        .text-box {
            padding: 14px;
            border-radius: 6px;
            font-size: 13px;
            line-height: 1.6;
        }
        .text-box.baseline {
            background: #FEF2F2;
            border: 1px solid #FECACA;
        }
        .text-box.new {
            background: #ECFDF5;
            border: 1px solid #A7F3D0;
        }
        .text-box-label {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 6px;
        }
        .explanation-box {
            background: var(--bg-gray);
            padding: 14px;
            border-radius: 6px;
            margin-top: 14px;
        }
        .explanation-box h5 {
            margin: 0 0 8px 0;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
        }
        .explanation-box p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.5;
        }
        .explanation-box.danger {
            background: #FEF2F2;
        }
        .explanation-box.danger h5 {
            color: #B91C1C;
        }
        .explanation-box.warning {
            background: #FFFBEB;
        }
        .explanation-box.warning h5 {
            color: #92400E;
        }
        .explanation-box.success {
            background: #ECFDF5;
        }
        .explanation-box.success h5 {
            color: #065F46;
        }
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }
        @media (max-width: 600px) {
            .summary-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        .stat-box {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 16px;
            text-align: center;
        }
        .stat-number {
            font-size: 28px;
            font-weight: 600;
            color: var(--accent);
        }
        .stat-number.high { color: var(--danger); }
        .stat-number.medium { color: var(--warning); }
        .stat-number.low { color: var(--success); }
        .stat-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
            text-transform: uppercase;
        }
        .concerns-list {
            background: #FFFBEB;
            border: 1px solid #FDE68A;
            border-left: 3px solid var(--warning);
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 20px;
        }
        .concerns-list h4 {
            margin: 0 0 12px 0;
            color: #92400E;
            font-size: 14px;
        }
        .concerns-list ol {
            margin: 0;
            padding-left: 20px;
        }
        .concerns-list li {
            color: #92400E;
            margin-bottom: 8px;
            font-size: 13px;
            line-height: 1.4;
        }
        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .filter-btn {
            padding: 8px 16px;
            border: 1px solid var(--border);
            border-radius: 20px;
            background: var(--bg-white);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.15s ease;
        }
        .filter-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        .filter-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        .results-section {
            display: none;
        }
        .results-section.visible {
            display: block;
        }
        .attorney-items {
            background: #F0F7FF;
            border: 1px solid #BFDBFE;
            border-left: 3px solid var(--accent);
            border-radius: 6px;
            padding: 16px;
            margin-top: 20px;
        }
        .attorney-items h4 {
            margin: 0 0 12px 0;
            color: var(--accent);
            font-size: 14px;
        }
        .attorney-items ul {
            margin: 0;
            padding-left: 20px;
        }
        .attorney-items li {
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-size: 13px;
            line-height: 1.4;
        }
        .demo-note {
            background: #FFFBEB;
            border: 1px solid #FDE68A;
            border-left: 3px solid var(--warning);
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 20px;
        }
        .demo-note h4 {
            margin: 0 0 8px 0;
            color: #92400E;
            font-size: 14px;
        }
        .demo-note p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="app-shell">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="#" onclick="goToLanding(); return false;" class="sidebar-logo" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo-icon"><svg viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg></div>
                    Legal Portal
                </a>
            </div>
            <div class="practice-selector">
                <label>Practice Area</label>
                <select class="practice-select" id="practiceSelect" onchange="switchPractice(this.value)">
                    <option value="immigration">Immigration</option>
                    <option value="contracts" selected>Contracts</option>
                    <option value="estate">Estate Planning</option>
                    <option value="general">General</option>
                </select>
            </div>
            <nav class="workflow-nav">
                <div class="workflow-label">Workflow</div>
                <ul class="workflow-steps">
                    <li class="workflow-step" onclick="alert('Upload tool coming soon')"><span class="step-indicator"><span class="step-number">1</span></span><span>Upload</span></li>
                    <li class="workflow-step active" onclick="window.location.href='redline.html'"><span class="step-indicator"><span class="step-number">2</span></span><span>Compare</span></li>
                    <li class="workflow-step" onclick="alert('Review tool coming soon')"><span class="step-indicator"><span class="step-number">3</span></span><span>Review</span></li>
                    <li class="workflow-step" onclick="alert('Export tool coming soon')"><span class="step-indicator"><span class="step-number">4</span></span><span>Export</span></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="about.html">How It Works</a>
                <a href="#" onclick="logout(); return false;">Sign Out</a>
            </div>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <span class="top-bar-title">Contracts â€” Compare</span>
                <div class="top-bar-actions"><a href="dashboard.html">Dashboard</a></div>
            </header>

            <div class="content-container wide">
                <div class="alert alert-warning"><strong>DRAFT - ATTORNEY REVIEW REQUIRED</strong><br>This analysis is for informational purposes only. All changes and recommendations must be reviewed by legal counsel before taking action.</div>

                <div class="card">
                    <h2 style="margin-bottom: 8px;">AI-Powered Redline Assistant</h2>
                    <p style="color: var(--text-secondary);">Compare a counterparty draft to your baseline template. Get plain-English summaries of changes and suggested edits.</p>
                </div>

                <!-- Upload Section -->
                <div id="uploadSection" class="card">
                    <h3>Step 1: Upload Documents</h3>

                    <div class="document-grid">
                        <div>
                            <label class="form-label">Baseline Document (Your Template)</label>
                            <div class="upload-zone" id="baselineZone" onclick="document.getElementById('baselineFile').click()">
                                <div class="icon">ðŸ“„</div>
                                <p><strong>Click to upload</strong> or drag and drop</p>
                                <p style="font-size: 12px; color: var(--text-muted);">PDF, DOCX, or TXT</p>
                                <input type="file" id="baselineFile" accept=".pdf,.docx,.txt" onchange="handleFileSelect(this, 'baseline')">
                                <div class="file-name" id="baselineName"></div>
                            </div>
                        </div>
                        <div>
                            <label class="form-label">Counterparty Draft</label>
                            <div class="upload-zone" id="counterpartyZone" onclick="document.getElementById('counterpartyFile').click()">
                                <div class="icon">ðŸ“„</div>
                                <p><strong>Click to upload</strong> or drag and drop</p>
                                <p style="font-size: 12px; color: var(--text-muted);">PDF, DOCX, or TXT</p>
                                <input type="file" id="counterpartyFile" accept=".pdf,.docx,.txt" onchange="handleFileSelect(this, 'counterparty')">
                                <div class="file-name" id="counterpartyName"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Document Type</label>
                        <select id="docType" class="form-select">
                            <option value="">Select document type...</option>
                            <option value="nda">Non-Disclosure Agreement (NDA)</option>
                            <option value="service_agreement">Service Agreement / MSA</option>
                            <option value="employment">Employment Agreement</option>
                            <option value="lease">Lease / Rental Agreement</option>
                            <option value="purchase">Purchase Agreement</option>
                            <option value="license">License Agreement</option>
                            <option value="other">Other Contract</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Preferred Language / Reference Clauses (Optional)</label>
                        <textarea id="preferredLanguage" class="form-textarea" placeholder="Paste any preferred language or standard clauses you'd like to restore or reference..."></textarea>
                    </div>

                    <button class="btn btn-primary" onclick="analyzeDocuments()" id="analyzeBtn">Analyze Documents</button>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="results-section">
                    <div class="demo-note">
                        <h4>Demo Mode</h4>
                        <p>This is a demonstration with sample comparison data. When connected to the Claude API, this tool will perform actual document comparison and analysis.</p>
                    </div>

                    <div class="card">
                        <h3>Comparison Summary</h3>

                        <div class="summary-stats">
                            <div class="stat-box">
                                <div class="stat-number" id="totalChanges">12</div>
                                <div class="stat-label">Total Changes</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-number high" id="highChanges">3</div>
                                <div class="stat-label">High Impact</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-number medium" id="mediumChanges">5</div>
                                <div class="stat-label">Medium Impact</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-number low" id="lowChanges">4</div>
                                <div class="stat-label">Low Impact</div>
                            </div>
                        </div>

                        <div class="concerns-list">
                            <h4>Key Concerns</h4>
                            <ol id="keyConcerns">
                                <li>Liability cap reduced from $1M to fees paid in last 12 months</li>
                                <li>Indemnification scope expanded to include third-party claims</li>
                                <li>Termination for convenience added (counterparty only)</li>
                            </ol>
                        </div>
                    </div>

                    <div class="card">
                        <h3>Detailed Changes</h3>

                        <div class="filter-bar">
                            <button class="filter-btn active" onclick="filterChanges('all')">All Changes</button>
                            <button class="filter-btn" onclick="filterChanges('high')">High Impact</button>
                            <button class="filter-btn" onclick="filterChanges('medium')">Medium Impact</button>
                            <button class="filter-btn" onclick="filterChanges('low')">Low Impact</button>
                        </div>

                        <div id="changesList">
                            <div class="change-item high" data-impact="high">
                                <div class="change-header">
                                    <div><strong>Section 8.2: Limitation of Liability</strong></div>
                                    <div class="change-badges">
                                        <span class="badge-impact high">High Impact</span>
                                        <span class="badge-favor unfavorable">Unfavorable</span>
                                    </div>
                                </div>
                                <div class="text-comparison">
                                    <div class="text-box baseline">
                                        <div class="text-box-label">Baseline Text</div>
                                        "In no event shall either party's liability exceed One Million Dollars ($1,000,000)."
                                    </div>
                                    <div class="text-box new">
                                        <div class="text-box-label">Counterparty Version</div>
                                        "In no event shall either party's liability exceed the fees paid under this Agreement in the twelve (12) months preceding the claim."
                                    </div>
                                </div>
                                <div class="explanation-box">
                                    <h5>Plain-English Explanation</h5>
                                    <p>The counterparty changed the liability cap from a fixed $1 million to a rolling 12-month fee calculation. For a contract with $50K annual fees, this reduces your maximum recovery from $1M to $50K - a 95% reduction in protection.</p>
                                </div>
                                <div class="explanation-box danger">
                                    <h5>Recommendation</h5>
                                    <p>Reject this change. Propose restoring the $1M cap, or negotiate a minimum floor (e.g., "the greater of $500,000 or fees paid in the preceding 12 months").</p>
                                </div>
                            </div>

                            <div class="change-item high" data-impact="high">
                                <div class="change-header">
                                    <div><strong>Section 9.1: Indemnification</strong></div>
                                    <div class="change-badges">
                                        <span class="badge-impact high">High Impact</span>
                                        <span class="badge-favor unfavorable">Unfavorable</span>
                                    </div>
                                </div>
                                <div class="text-comparison">
                                    <div class="text-box baseline">
                                        <div class="text-box-label">Baseline Text</div>
                                        "Each party shall indemnify the other against claims arising from its own negligence or willful misconduct."
                                    </div>
                                    <div class="text-box new">
                                        <div class="text-box-label">Counterparty Version</div>
                                        "Client shall indemnify Provider against any and all claims, including third-party claims, arising from or related to Client's use of the Services."
                                    </div>
                                </div>
                                <div class="explanation-box">
                                    <h5>Plain-English Explanation</h5>
                                    <p>The indemnification was changed from mutual (both parties protect each other) to one-sided (only you indemnify them). It also expands scope to include third-party claims regardless of fault.</p>
                                </div>
                                <div class="explanation-box danger">
                                    <h5>Recommendation</h5>
                                    <p>Push back strongly. Restore mutual indemnification and limit scope to claims caused by the indemnifying party's actions.</p>
                                </div>
                            </div>

                            <div class="change-item medium" data-impact="medium">
                                <div class="change-header">
                                    <div><strong>Section 11.2: Termination for Convenience</strong></div>
                                    <div class="change-badges">
                                        <span class="badge-impact medium">Medium Impact</span>
                                        <span class="badge-favor unfavorable">Unfavorable</span>
                                    </div>
                                </div>
                                <div class="text-comparison">
                                    <div class="text-box baseline">
                                        <div class="text-box-label">Baseline Text</div>
                                        [No termination for convenience provision]
                                    </div>
                                    <div class="text-box new">
                                        <div class="text-box-label">Counterparty Version</div>
                                        "Provider may terminate this Agreement for any reason upon thirty (30) days written notice."
                                    </div>
                                </div>
                                <div class="explanation-box">
                                    <h5>Plain-English Explanation</h5>
                                    <p>The counterparty added a right to terminate the contract at any time for any reason with 30 days notice. You don't have the same right.</p>
                                </div>
                                <div class="explanation-box warning">
                                    <h5>Recommendation</h5>
                                    <p>Either delete this provision or make it mutual. If they insist, negotiate for longer notice period (60-90 days) and pro-rata refund of prepaid fees.</p>
                                </div>
                            </div>

                            <div class="change-item low" data-impact="low">
                                <div class="change-header">
                                    <div><strong>Section 15.1: Governing Law</strong></div>
                                    <div class="change-badges">
                                        <span class="badge-impact low">Low Impact</span>
                                        <span class="badge-favor neutral">Neutral</span>
                                    </div>
                                </div>
                                <div class="text-comparison">
                                    <div class="text-box baseline">
                                        <div class="text-box-label">Baseline Text</div>
                                        "This Agreement shall be governed by the laws of the State of New York."
                                    </div>
                                    <div class="text-box new">
                                        <div class="text-box-label">Counterparty Version</div>
                                        "This Agreement shall be governed by the laws of the State of Delaware."
                                    </div>
                                </div>
                                <div class="explanation-box">
                                    <h5>Plain-English Explanation</h5>
                                    <p>Governing law changed from New York to Delaware. Both are business-friendly jurisdictions with well-developed contract law.</p>
                                </div>
                                <div class="explanation-box success">
                                    <h5>Recommendation</h5>
                                    <p>Acceptable if venue remains reasonable. Confirm whether jurisdiction clause also changed and consider litigation convenience.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="attorney-items">
                        <h4>Items Requiring Attorney Decision</h4>
                        <ul>
                            <li>Whether to accept modified liability cap or counter with alternative structure</li>
                            <li>Acceptability of one-sided termination right given business relationship</li>
                            <li>Review IP ownership clause changes against company policy</li>
                        </ul>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h3>Export Options</h3>
                        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="exportReport('pdf')">Export PDF Report</button>
                            <button class="btn btn-secondary" onclick="exportReport('docx')">Export Word Document</button>
                            <button class="btn btn-secondary" onclick="exportReport('email')">Email Summary</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        let baselineFile = null;
        let counterpartyFile = null;

        function handleFileSelect(input, type) {
            const file = input.files[0];
            if (!file) return;

            if (type === 'baseline') {
                baselineFile = file;
                document.getElementById('baselineZone').classList.add('has-file');
                document.getElementById('baselineName').textContent = file.name;
            } else {
                counterpartyFile = file;
                document.getElementById('counterpartyZone').classList.add('has-file');
                document.getElementById('counterpartyName').textContent = file.name;
            }
        }

        // Drag and drop handlers
        ['baselineZone', 'counterpartyZone'].forEach(zoneId => {
            const zone = document.getElementById(zoneId);
            const type = zoneId === 'baselineZone' ? 'baseline' : 'counterparty';
            const input = document.getElementById(type + 'File');

            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.classList.add('dragover');
            });

            zone.addEventListener('dragleave', () => {
                zone.classList.remove('dragover');
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    input.files = files;
                    handleFileSelect(input, type);
                }
            });
        });

        function analyzeDocuments() {
            const docType = document.getElementById('docType').value;

            if (!baselineFile || !counterpartyFile) {
                alert('Please upload both documents to continue.');
                return;
            }

            if (!docType) {
                alert('Please select a document type.');
                return;
            }

            const btn = document.getElementById('analyzeBtn');
            btn.textContent = 'Analyzing...';
            btn.disabled = true;

            setTimeout(() => {
                document.getElementById('uploadSection').style.display = 'none';
                document.getElementById('resultsSection').classList.add('visible');
                btn.textContent = 'Analyze Documents';
                btn.disabled = false;
            }, 2000);
        }

        function filterChanges(impact) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            document.querySelectorAll('.change-item').forEach(item => {
                if (impact === 'all' || item.dataset.impact === impact) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function exportReport(format) {
            alert('Export to ' + format.toUpperCase() + ' would be generated here. This feature requires API integration.');
        }

        function switchPractice(p) { localStorage.setItem('legal-portal-practice', p); window.location.href = 'dashboard.html'; }
        function goToLanding() {
            localStorage.removeItem('legal-portal-practice');
            localStorage.removeItem('legal-portal-step');
            window.location.href = 'dashboard.html';
        }
        function logout() {
            localStorage.removeItem('legal-portal-auth');
            localStorage.removeItem('legal-portal-auth-time');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
